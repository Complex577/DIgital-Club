{% extends "base.html" %}

{% block title %}Edit Profile - Digital Club{% endblock %}

{% block extra_head %}
<style>
    .edit-profile-page {
        background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%);
        min-height: 100vh;
        padding: 2rem 0;
    }
    
    .profile-form {
        background: rgba(0, 0, 0, 0.3);
        border: 1px solid var(--border-color);
        border-radius: 15px;
        padding: 2rem;
        margin-bottom: 2rem;
    }
    
    .form-section {
        margin-bottom: 2rem;
        padding-bottom: 2rem;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .form-section:last-child {
        border-bottom: none;
        margin-bottom: 0;
    }
    
    .section-title {
        color: var(--primary-color);
        font-size: 1.2rem;
        font-weight: 600;
        margin-bottom: 1.5rem;
        display: flex;
        align-items: center;
    }
    
    .section-title i {
        margin-right: 0.5rem;
        font-size: 1.3rem;
    }
    
    .form-group {
        margin-bottom: 1.5rem;
    }
    
    .form-label {
        color: var(--text-primary);
        font-weight: 500;
        margin-bottom: 0.5rem;
        display: block;
    }
    
    .form-control {
        background: rgba(0, 0, 0, 0.3);
        border: 1px solid var(--border-color);
        border-radius: 8px;
        color: var(--text-primary);
        padding: 0.75rem;
        width: 100%;
        transition: all 0.3s ease;
    }
    
    .form-control:focus {
        border-color: var(--primary-color);
        box-shadow: 0 0 0 2px rgba(0, 255, 255, 0.2);
        outline: none;
        background: rgba(0, 0, 0, 0.4);
    }
    
    .form-control::placeholder {
        color: var(--text-muted);
    }
    
    .form-select {
        background: rgba(0, 0, 0, 0.3);
        border: 1px solid var(--border-color);
        border-radius: 8px;
        color: var(--text-primary);
        padding: 0.75rem;
        width: 100%;
    }
    
    .form-select:focus {
        border-color: var(--primary-color);
        box-shadow: 0 0 0 2px rgba(0, 255, 255, 0.2);
        outline: none;
    }
    
    .btn-primary {
        background: var(--primary-color);
        border: 1px solid var(--primary-color);
        color: var(--bg-primary);
        padding: 0.75rem 2rem;
        border-radius: 25px;
        font-weight: 600;
        transition: all 0.3s ease;
    }
    
    .btn-primary:hover {
        background: var(--secondary-color);
        border-color: var(--secondary-color);
        transform: translateY(-2px);
    }
    
    .btn-secondary {
        background: transparent;
        border: 1px solid var(--border-color);
        color: var(--text-primary);
        padding: 0.75rem 2rem;
        border-radius: 25px;
        font-weight: 600;
        transition: all 0.3s ease;
    }
    
    .btn-secondary:hover {
        border-color: var(--primary-color);
        color: var(--primary-color);
    }
    
    .profile-image-preview {
        width: 150px;
        height: 150px;
        border-radius: 50%;
        object-fit: cover;
        border: 3px solid var(--primary-color);
        margin-bottom: 1rem;
    }
    
    .file-input-wrapper {
        position: relative;
        display: inline-block;
        cursor: pointer;
        background: rgba(0, 255, 255, 0.1);
        border: 1px solid var(--primary-color);
        border-radius: 8px;
        padding: 0.75rem 1.5rem;
        color: var(--primary-color);
        transition: all 0.3s ease;
    }
    
    .file-input-wrapper:hover {
        background: rgba(0, 255, 255, 0.2);
    }
    
    .file-input-wrapper input[type="file"] {
        position: absolute;
        left: -9999px;
    }
    
    .projects-json {
        font-family: 'Courier New', monospace;
        font-size: 0.9rem;
        background: rgba(0, 0, 0, 0.5);
        border: 1px solid var(--border-color);
        border-radius: 8px;
        padding: 1rem;
        color: var(--text-primary);
        min-height: 200px;
    }
    
    .help-text {
        font-size: 0.8rem;
        color: var(--text-muted);
        margin-top: 0.5rem;
    }
</style>
{% endblock %}

{% block content %}
<div class="edit-profile-page">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <div class="profile-form" data-aos="fade-up">
                    <div class="text-center mb-4">
                        <h2 class="text-primary mb-2">Edit Profile</h2>
                        <p class="text-secondary">Update your personal information and preferences</p>
                    </div>
                    
                    <form method="POST" enctype="multipart/form-data">
                        <!-- Profile Image Section -->
                        <div class="form-section">
                            <h4 class="section-title">
                                <i class="fas fa-camera"></i>
                                Profile Image
                            </h4>
                            
                            <div class="text-center mb-3">
                                {% if member and member.profile_image %}
                                    <img src="{{ url_for('static', filename='uploads/profiles/' + member.profile_image) }}" 
                                         alt="Profile Preview" class="profile-image-preview" id="image-preview">
                                {% else %}
                                    <div class="profile-image-preview d-flex align-items-center justify-content-center" 
                                         style="background: var(--primary-color); color: var(--bg-primary); font-size: 3rem;" id="image-preview">
                                        <i class="fas fa-user"></i>
                                    </div>
                                {% endif %}
                            </div>
                            
                            <div class="form-group text-center">
                                <label class="file-input-wrapper">
                                    <i class="fas fa-upload"></i> Choose Image
                                    <input type="file" name="profile_image" id="profile_image" accept="image/*" onchange="previewImage(this)">
                                </label>
                                <div class="help-text">PNG, JPG, JPEG, or GIF (max 5MB)</div>
                            </div>
                        </div>
                        
                        <!-- Basic Information -->
                        <div class="form-section">
                            <h4 class="section-title">
                                <i class="fas fa-user"></i>
                                Basic Information
                            </h4>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="full_name" class="form-label">Full Name *</label>
                                        <input type="text" class="form-control" id="full_name" name="full_name" 
                                               value="{{ member.full_name if member else '' }}" required>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="title" class="form-label">Professional Title</label>
                                        <input type="text" class="form-control" id="title" name="title" 
                                               value="{{ member.title if member else '' }}" 
                                               placeholder="e.g., Software Developer, Data Scientist">
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="bio" class="form-label">Bio</label>
                                <textarea class="form-control" id="bio" name="bio" rows="4" 
                                          placeholder="Tell us about yourself...">{{ member.bio if member else '' }}</textarea>
                            </div>
                        </div>
                        
                        <!-- Academic Information -->
                        <div class="form-section">
                            <h4 class="section-title">
                                <i class="fas fa-graduation-cap"></i>
                                Academic Information
                            </h4>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="course" class="form-label">Course</label>
                                        <input type="text" class="form-control" id="course" name="course" 
                                               value="{{ member.course if member else '' }}" 
                                               placeholder="e.g., Computer Science, Information Technology">
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="year" class="form-label">Year</label>
                                        <input type="text" class="form-control" id="year" name="year" 
                                               value="{{ member.year if member else '' }}" 
                                               placeholder="e.g., Year 2, Graduate">
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="status" class="form-label">Status</label>
                                <select class="form-select" id="status" name="status">
                                    <option value="student" {% if member and member.status == 'student' %}selected{% endif %}>Student</option>
                                    <option value="alumni" {% if member and member.status == 'alumni' %}selected{% endif %}>Alumni</option>
                                </select>
                                <div class="help-text">Change your status from student to alumni when you graduate</div>
                            </div>
                        </div>
                        
                        <!-- Contact Information -->
                        <div class="form-section">
                            <h4 class="section-title">
                                <i class="fas fa-address-book"></i>
                                Contact Information
                            </h4>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="phone" class="form-label">Phone Number</label>
                                        <input type="tel" class="form-control" id="phone" name="phone" 
                                               value="{{ member.phone if member else '' }}" 
                                               placeholder="+255 XXX XXX XXX">
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="areas_of_interest" class="form-label">Areas of Interest</label>
                                        <input type="text" class="form-control" id="areas_of_interest" name="areas_of_interest" 
                                               value="{{ member.areas_of_interest if member else '' }}" 
                                               placeholder="e.g., Web Development, AI, Data Science (comma-separated)">
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Social Links -->
                        <div class="form-section">
                            <h4 class="section-title">
                                <i class="fas fa-share-alt"></i>
                                Social Links (Optional)
                            </h4>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="github" class="form-label">GitHub Profile</label>
                                        <input type="text" class="form-control" id="github" name="github" 
                                               value="{{ member.github if member else '' }}" 
                                               placeholder="https://github.com/username">
                                        <div class="help-text">Optional: Your GitHub profile URL</div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="linkedin" class="form-label">LinkedIn Profile</label>
                                        <input type="text" class="form-control" id="linkedin" name="linkedin" 
                                               value="{{ member.linkedin if member else '' }}" 
                                               placeholder="https://linkedin.com/in/username">
                                        <div class="help-text">Optional: Your LinkedIn profile URL</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Personal Projects -->
                        <div class="form-section">
                            <h4 class="section-title">
                                <i class="fas fa-project-diagram"></i>
                                Personal Projects
                            </h4>
                            
                            <div class="form-group">
                                <label for="projects" class="form-label">Projects (JSON Format)</label>
                                <textarea class="projects-json" id="projects" name="projects" rows="8" 
                                          placeholder='[
  {
    "name": "Project Name",
    "description": "Project description",
    "technologies": ["React", "Node.js", "MongoDB"],
    "github_url": "https://github.com/username/project",
    "demo_url": "https://project-demo.com"
  }
]'>{{ member.projects_json if member and member.projects_json else '' }}</textarea>
                                <div class="help-text">
                                    Enter your projects in JSON format. Each project should have name, description, technologies, and optional URLs.
                                </div>
                            </div>
                        </div>
                        
                        <!-- Form Actions -->
                        <div class="text-center">
                            <button type="submit" class="btn btn-primary me-3">
                                <i class="fas fa-save"></i> Save Changes
                            </button>
                            <a href="{{ url_for('member.dashboard') }}" class="btn btn-secondary">
                                <i class="fas fa-arrow-left"></i> Cancel
                            </a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
    function previewImage(input) {
        if (input.files && input.files[0]) {
            const reader = new FileReader();
            reader.onload = function(e) {
                const preview = document.getElementById('image-preview');
                if (preview.tagName === 'IMG') {
                    preview.src = e.target.result;
                } else {
                    preview.innerHTML = `<img src="Tsh {e.target.result}" alt="Profile Preview" class="profile-image-preview">`;
                }
            };
            reader.readAsDataURL(input.files[0]);
        }
    }
    
    // Initialize AOS animations
    AOS.init({
        duration: 1000,
        once: true,
        offset: 100
    });
</script>
{% endblock %}
